# Neural Tangent Generalization Attacks (NTGA)
[**ICML 2021 Video**]()
| [**Paper**]()
| [**Install Guide**](#installation)
| [**Quickstart**](#Usage)
| [**Unlearnable Datasets**](#unlearnable-datasets)

![Last Commit](https://img.shields.io/github/last-commit/lionelmessi6410/Neural-Tangent-Generalization-Attacks?color=red)
[![License](https://img.shields.io/github/license/lionelmessi6410/Neural-Tangent-Generalization-Attacks)](https://github.com/lionelmessi6410/Neural-Tangent-Generalization-Attacks/blob/main/LICENSE)

# Overview
This is the repo for [Neural Tangent Generalization Attacks](), Chia-Hung Yuan and Shan-Hung Wu, In Proceedings of ICML 2021.

We study generalization attacks, a new direction for poisoning attacks, where an attacker aims to modify training data in order to spoil training process such that a trained network lacks generalizability. We devise Neural Tangent Generalization Attacks (NTGA), a first efficient work enabling clean-label, black-box generalization attacks against Deep Neural Networks.

We provide the *unlearnable* MNIST, CIFAR-10, and 2-class ImageNet generated by NTGA, which can be found and downloaded in [Unlearnable Datasets](#unlearnable-datasets).


Our code uses the [Neural Tangents](https://github.com/google/neural-tangents) library built on top of [JAX](https://github.com/google/jax) and [TensorFlow](https://www.tensorflow.org/). 

<!-- # Generate NTGA Attack
python generate_attack.py --model_type cnn --dataset mnist --eps 0.3 --save_path ./data/
python generate_attack.py --model_type fnn --dataset cifar10 --eps 0.032 --save_path ./data/

# Evaluate
python evaluate.py --model_type fnn_relu --dataset mnist --dtype Clean --save_path ./figure/
python evaluate.py --model_type fnn_relu --dataset mnist --dtype NTGA --x_train_path ./data/x_train_mnist_ntga_cnn_best.npy --y_train_path ./data/y_train_mnist.npy --save_path ./figure/

python evaluate.py --model_type resnet18 --dataset cifar10 --dtype Clean --epoch 200 --batch_size 128 --save_path ./figure/
python evaluate.py --model_type resnet18 --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_fnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 200 --batch_size 128 --save_path ./figure/

python evaluate.py --model_type resnet34 --dataset cifar10 --dtype Clean --epoch 200 --batch_size 128 --save_path ./figure/
python evaluate.py --model_type resnet34 --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_fnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 200 --batch_size 128 --save_path ./figure/

python evaluate.py --model_type densenet121 --dataset cifar10 --dtype Clean --batch_size 128 --save_path ./figure/
python evaluate.py --model_type densenet121 --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_cnn_best.npy --y_train_path ./data/y_train_cifar10.npy --batch_size 128 --save_path ./figure/

python evaluate.py --model_type resnet18 --dataset imagenet --dtype Clean --x_train_path ./data/x_train_imagenet.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --batch_size 128 --save_path ./figure/
python evaluate.py --model_type resnet18 --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_cnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --batch_size 128 --save_path ./figure/

## MNIST
python evaluate.py --model_type fnn --dataset mnist --dtype Clean --epoch 10 --save_path ./figure/
python evaluate.py --model_type fnn_relu --dataset mnist --dtype Clean --epoch 10 --save_path ./figure/
python evaluate.py --model_type cnn --dataset mnist --dtype Clean --epoch 10 --save_path ./figure/

python evaluate.py --model_type fnn --dataset mnist --dtype NTGA --x_train_path ./data/x_train_mnist_ntga_fnn_best.npy --y_train_path ./data/y_train_mnist.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type fnn_relu --dataset mnist --dtype NTGA --x_train_path ./data/x_train_mnist_ntga_fnn_best.npy --y_train_path ./data/y_train_mnist.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type cnn --dataset mnist --dtype NTGA --x_train_path ./data/x_train_mnist_ntga_fnn_best.npy --y_train_path ./data/y_train_mnist.npy --epoch 10 --save_path ./figure/

python evaluate.py --model_type fnn --dataset mnist --dtype NTGA --x_train_path ./data/x_train_mnist_ntga_cnn_best.npy --y_train_path ./data/y_train_mnist.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type fnn_relu --dataset mnist --dtype NTGA --x_train_path ./data/x_train_mnist_ntga_cnn_best.npy --y_train_path ./data/y_train_mnist.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type cnn --dataset mnist --dtype NTGA --x_train_path ./data/x_train_mnist_ntga_cnn_best.npy --y_train_path ./data/y_train_mnist.npy --epoch 10 --save_path ./figure/

## CIFAR10
python evaluate.py --model_type fnn --dataset cifar10 --dtype clean --epoch 10 --save_path ./figure/
python evaluate.py --model_type fnn_relu --dataset cifar10 --dtype clean --epoch 10 --save_path ./figure/
python evaluate.py --model_type cnn --dataset cifar10 --dtype clean --epoch 10 --save_path ./figure/
python evaluate.py --model_type resnet18 --dataset cifar10 --dtype clean --epoch 10 --batch_size 128 --save_path ./figure/
python evaluate.py --model_type densenet121 --dataset cifar10 --dtype clean --epoch 10 --batch_size 128 --save_path ./figure/

python evaluate.py --model_type fnn --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_fnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type fnn_relu --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_fnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type cnn --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_fnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type resnet18 --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_fnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 10 --batch_size 128 --save_path ./figure/
python evaluate.py --model_type densenet121 --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_fnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 10 --batch_size 128 --save_path ./figure/

python evaluate.py --model_type fnn --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_cnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type fnn_relu --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_cnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type cnn --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_cnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type resnet18 --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_cnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 10 --batch_size 128 --save_path ./figure/
python evaluate.py --model_type densenet121 --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_cnn_best.npy --y_train_path ./data/y_train_cifar10.npy --epoch 10 --batch_size 128 --save_path ./figure/

## ImageNet
python evaluate.py --model_type fnn --dataset imagenet --dtype Clean --x_train_path ./data/x_train_imagenet.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type fnn_relu --dataset imagenet --dtype Clean --x_train_path ./data/x_train_imagenet.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type cnn --dataset imagenet --dtype Clean --x_train_path ./data/x_train_imagenet.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type resnet18 --dataset imagenet --dtype Clean --x_train_path ./data/x_train_imagenet.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --batch_size 128 --save_path ./figure/
python evaluate.py --model_type densenet121 --dataset imagenet --dtype Clean --x_train_path ./data/x_train_imagenet.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --batch_size 128 --save_path ./figure/

python evaluate.py --model_type fnn --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_fnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type fnn_relu --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_fnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type cnn --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_fnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type resnet18 --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_fnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --batch_size 128 --save_path ./figure/
python evaluate.py --model_type densenet121 --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_fnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --batch_size 128 --save_path ./figure/

python evaluate.py --model_type fnn --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_cnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type fnn_relu --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_cnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type cnn --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_cnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --save_path ./figure/
python evaluate.py --model_type resnet18 --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_cnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --batch_size 128 --save_path ./figure/
python evaluate.py --model_type densenet121 --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_cnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --epoch 10 --batch_size 128 --save_path ./figure/

# Plot Learning Dynamics
python plot_learning_dynamics.py --dataset mnist --dtype Clean --save_path ./figure/
python plot_learning_dynamics.py --dataset mnist --dtype NTGA --x_train_path ./data/x_train_mnist_ntga_fnn_best.npy --y_train_path ./data/y_train_mnist.npy --save_path ./figure/

python plot_learning_dynamics.py --dataset cifar10 --dtype Clean --save_path ./figure/
python plot_learning_dynamics.py --dataset cifar10 --dtype NTGA --x_train_path ./data/x_train_cifar10_ntga_fnn_best.npy --y_train_path ./data/y_train_mnist.npy --save_path ./figure/

python plot_learning_dynamics.py --dataset imagenet --dtype Clean --x_train_path ./data/x_train_imagenet.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --save_path ./figure/
python plot_learning_dynamics.py --dataset imagenet --dtype NTGA --x_train_path ./data/x_train_imagenet_ntga_fnn_best.npy --y_train_path ./data/y_train_imagenet.npy --x_test_path ./data/x_test_imagenet.npy --y_test_path ./data/y_test_imagenet.npy --train_size 256 --save_path ./figure/

# Plot Visualization
python plot_visualization.py --dataset mnist --x_train_path ./data/x_train_mnist.npy --x_train_ntga_path ./data/x_train_mnist_ntga_fnn_t1.npy --save_path ./figure/

python plot_visualization.py --dataset cifar10 --x_train_path ./data/x_train_cifar10.npy --x_train_ntga_path ./data/x_train_cifar10_ntga_fnn_t1.npy --save_path ./figure/

python plot_visualization.py --dataset imagenet --x_train_path ./data/x_train_imagenet.npy --x_train_ntga_path ./data/x_train_imagenet_ntga_fnn_best.npy --save_path ./figure/


MNIST FNN 64
MNIST CNN 64

CIFAR FNN 4096
CIFAR CNN 8

IMAGENET FNN 1
IMAGENET CNN 1
 -->